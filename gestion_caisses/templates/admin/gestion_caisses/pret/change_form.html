{% extends "admin/change_form.html" %}
{% load i18n %}

{% block content %}
  {% if pret_summary %}
    <div class="card" style="margin-bottom:16px;">
      <div class="card-header" style="display:flex;align-items:center;justify-content:space-between;">
        <div>
          <strong>Prêt {{ pret_summary.numero_pret }}</strong>
          <span class="ml-2 badge" style="background:#6f42c1;">{{ pret_summary.statut }}</span>
        </div>
        <div style="min-width:210px;">
          <div style="width:100%;background:#f0f0f0;border-radius:10px;overflow:hidden;">
            <div style="width: {{ pret_summary.progression|floatformat:0 }}%;height:12px;background:#28a745;"></div>
          </div>
          <small style="display:block;text-align:right;">{{ pret_summary.progression|floatformat:1 }}%</small>
        </div>
      </div>
      <div class="card-body" style="display:grid;grid-template-columns: repeat(auto-fit, minmax(220px,1fr));gap:12px;">
        <div>
          <div><small>Total accordé</small></div>
          <div style="font-weight:700;">{{ pret_summary.montant_accord|floatformat:0 }} FCFA</div>
        </div>
        <div>
          <div><small>Intérêts</small></div>
          <div style="font-weight:700;">{{ pret_summary.montant_interet|floatformat:0 }} FCFA</div>
        </div>
        <div>
          <div><small>Net à payer</small></div>
          <div style="font-weight:700;">{{ pret_summary.net_a_payer|floatformat:0 }} FCFA</div>
        </div>
        <div>
          <div><small>Remboursé</small></div>
          <div style="font-weight:700;color:#28a745;">{{ pret_summary.montant_rembourse|floatformat:0 }} FCFA</div>
        </div>
        <div>
          <div><small>Reste</small></div>
          <div style="font-weight:700;color:#d9534f;">{{ pret_summary.montant_restant|floatformat:0 }} FCFA</div>
        </div>
        <div>
          <div><small>Échéances</small></div>
          <div style="font-weight:700;">{{ pret_summary.echeances.payees }}/{{ pret_summary.echeances.total }} payées</div>
          {% if pret_summary.echeances.en_retard and pret_summary.echeances.en_retard > 0 %}
            <div><small style="color:#ff5722;">{{ pret_summary.echeances.en_retard }} en retard</small></div>
          {% endif %}
        </div>
        {% if pret_summary.prochaine_echeance %}
          <div>
            <div><small>Prochaine échéance</small></div>
            <div style="font-weight:700;">N° {{ pret_summary.prochaine_echeance.numero }} - {{ pret_summary.prochaine_echeance.montant|floatformat:0 }} FCFA</div>
            <div><small>{{ pret_summary.prochaine_echeance.date|date:'d/m/Y' }}</small></div>
          </div>
        {% endif %}
      </div>
    </div>
  {% endif %}

  {{ block.super }}
{% endblock %}


