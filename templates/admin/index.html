{% extends "admin/base_site.html" %}
{% load i18n %}

{% block content_title %}
  <h1>🏠 Tableau de bord</h1>
{% endblock %}

{% block content %}
  <!-- Bandeau cartes d'actions -->
  <div class="cards">
    <button id="pwa-install-btn" class="card" onclick="installPWA()" style="display:none;cursor:pointer;">
      <div class="icon">📌</div>
      <div class="title">Installer l'application</div>
      <div class="desc">Créer un raccourci sur votre bureau</div>
    </button>
    <a class="card" href="/adminsecurelogin/gestion_caisses/pret/">
      <div class="icon">📄</div>
      <div class="title">Prêts</div>
      <div class="desc">Gérer les prêts et validations</div>
    </a>
    <a class="card" href="/adminsecurelogin/gestion_caisses/caisse/">
      <div class="icon">🏦</div>
      <div class="title">Caisses</div>
      <div class="desc">Paramétrer et suivre les caisses</div>
    </a>
    <a class="card" href="/adminsecurelogin/gestion_caisses/membre/">
      <div class="icon">👥</div>
      <div class="title">Membres</div>
      <div class="desc">Inscrire et gérer les membres</div>
    </a>
    <a class="card" href="/adminsecurelogin/gestion_caisses/notification/">
      <div class="icon">🔔</div>
      <div class="title">Notifications</div>
      <div class="desc">Suivi des alertes et demandes</div>
    </a>
    <a class="card" href="/gestion-caisses/admin-frontend/">
      <div class="icon">📊</div>
      <div class="title">Rapports</div>
      <div class="desc">Rapports globaux et par caisse</div>
    </a>
    <a class="card" href="/gestion-caisses/guide-application.pdf">
      <div class="icon">📘</div>
      <div class="title">Guide</div>
      <div class="desc">Télécharger le guide PDF</div>
    </a>
  </div>

  <!-- Applications (grille) -->
  <div class="app-grid">
    {% for app in app_list %}
      <div class="app-card">
        <div class="app-card__header">
          <h2 style="margin:0; font-size:16px;">{{ app.name }}</h2>
          <small class="text-muted">{{ app.app_label }}</small>
        </div>
        <ul class="model-list">
          {% for model in app.models %}
            <li class="model-item">
              {% if model.admin_url %}<a href="{{ model.admin_url }}" class="model-link">{{ model.name }}</a>{% else %}{{ model.name }}{% endif %}
              <span class="model-actions">
                {% if model.add_url %}<a class="mini-btn" href="{{ model.add_url }}">+ Ajouter</a>{% endif %}
                {% if model.admin_url %}<a class="mini-btn" href="{{ model.admin_url }}">Voir</a>{% endif %}
              </span>
            </li>
          {% endfor %}
        </ul>
      </div>
    {% endfor %}
  </div>
{% endblock %}

{% block extrahead %}
{{ block.super }}
<style>
  .app-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 16px;
  }
  .cards {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 12px;
    margin-bottom: 16px;
  }
  .card {
    display: grid;
    grid-template-rows: auto auto auto;
    align-content: start;
    padding: 14px;
    border-radius: 12px;
    border: 1px solid #e5e7eb;
    background: #fff;
    text-decoration: none;
    color: inherit;
    box-shadow: 0 2px 6px rgba(0,0,0,.04);
    transition: transform .12s ease, box-shadow .12s ease;
  }
  .card:hover { transform: translateY(-2px); box-shadow: 0 6px 14px rgba(0,0,0,.06); }
  .card .icon { font-size: 22px; }
  .card .title { font-weight: 700; margin-top: 6px; }
  .card .desc { color: #666; font-size: 12px; margin-top: 2px; }
  .app-card {
    background: #fff;
    border: 1px solid #e5e7eb;
    border-radius: 12px;
    box-shadow: 0 2px 6px rgba(0,0,0,.04);
    padding: 14px;
  }
  .app-card__header { display:flex; align-items:baseline; justify-content:space-between; margin-bottom:8px; }
  .model-list { list-style: none; padding: 0; margin: 0; }
  .model-item { display:flex; align-items:center; justify-content:space-between; padding: 8px 0; border-top: 1px dashed #eee; }
  .model-item:first-child { border-top: 0; }
  .model-link { font-weight: 600; }
  .mini-btn { font-size: 12px; margin-left: 8px; color: #6f42c1; }
  @media (max-width: 640px){ .app-grid{ grid-template-columns: 1fr; } }
</style>
{% endblock %}


